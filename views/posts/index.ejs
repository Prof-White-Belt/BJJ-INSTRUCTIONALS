<%- include("../partials/header.ejs") %>

<h1>ðŸ“¢ Community Reviews</h1>

<a href="/posts/new"> Write a Review</a>

<% posts.forEach(post => { %>
  <div class="post-card">
    <h2><%= post.title %></h2>
    <p><%= post.body %></p>
    <small>By: <%= post.userId.username %> | <%= post.createdAt.toDateString() %></small>

    <% if (user && post.userId._id.toString() === user._id.toString()) { %>
      <!-- Show edit/delete only if current user is the owner -->
      <a href="/posts/<%= post._id %>/edit"> Edit</a>

      <form method="POST" action="/posts/<%= post._id %>?_method=DELETE" style="display:inline">
        <button type="submit"> Delete</button>
      </form>
    <% } %>
  </div>
<% }) %>

<%- include("../partials/footer.ejs") %>
